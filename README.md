# ğŸ“º **MuxAI AdsPlacement**

> **AI-Powered Seamless Video Ad Integration** â€¢ Transforming video advertising with GPT-4 Vision, Sora 2.0, and Mux

[![Mux](https://img.shields.io/badge/Powered%20by-Mux-FF0080?style=for-the-badge&logo=mux)](https://mux.com)
[![OpenAI](https://img.shields.io/badge/AI-GPT--4%20Vision-00A67E?style=for-the-badge&logo=openai)](https://openai.com)
[![Next.js](https://img.shields.io/badge/Built%20with-Next.js%2015-000000?style=for-the-badge&logo=next.js)](https://nextjs.org)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.0-3178C6?style=for-the-badge&logo=typescript)](https://www.typescriptlang.org/)

---

## ğŸ¯ **Overview**

**MuxAI AdsPlacement** is a revolutionary platform that uses artificial intelligence to seamlessly integrate product advertisements into existing videos. Unlike traditional video ads that interrupt the viewing experience, our system analyzes video content frame-by-frame, identifies natural transition points, and generates contextually-aware ad content that flows naturally with the original footage.

### **ğŸ† Built for DEV Worldwide Show and Tell Challenge**

**Prize Track:** Mux Category ($1,500 First Place)

---

## ğŸ¬ **The Problem**

Traditional video advertising faces critical challenges:

- âŒ **Jarring interruptions** that break viewer immersion
- âŒ **Generic ads** with no context to video content
- âŒ **Manual editing** required for seamless integration
- âŒ **Poor engagement** due to disruptive placement
- âŒ **Time-consuming** production workflows
- âŒ **Limited personalization** capabilities

### **Impact:**

- ğŸ“‰ 65% of viewers skip pre-roll ads within 5 seconds
- ğŸ“‰ Traditional mid-roll ads cause 45% viewer drop-off
- ğŸ“‰ Manual ad integration costs $500-2000 per video

---

## ğŸ’¡ **Our Solution**

**MuxAI AdsPlacement** leverages cutting-edge AI to create a **fully automated, intelligent ad integration pipeline**:

```
Original Video â†’ AI Scene Analysis â†’ Smart Ad Placement â†’ Contextual Ad Generation â†’ Seamless Stitching
```

### **Key Innovation:**

1. **ğŸ” GPT-4 Vision Analysis** - Understands visual context and scene transitions
2. **ğŸ¨ AI Ad Generation** - Creates custom ads that match video aesthetics
3. **ğŸ¬ Seamless Integration** - Stitches ads at natural transition points
4. **ğŸ“Š Professional Delivery** - Mux-powered streaming with advanced features

---

## âœ¨ **Features**

### **ğŸ¥ Phase 1: Intelligent Video Analysis**

#### **Automatic Scene Detection**

- **PySceneDetect** integration for precise transition identification
- Threshold-based detection (`threshold=27.0`) for optimal accuracy
- Extracts frames at exact transition timestamps
- Generates visual previews for every detected scene change

**Technical Implementation:**

```python
# Scene detection with adaptive threshold
detect(video_path, ContentDetector(threshold=27.0))
# Extracts frames at transition boundaries
# Returns: [(frame_a_time, frame_a_url), (frame_b_time, frame_b_url)]
```

#### **Mux Upload & Processing**

- Direct upload via Mux API
- Automatic transcoding to adaptive bitrate formats
- Auto-generated captions (English)
- Thumbnail generation for preview

**Mux Asset Creation:**

```typescript
mux.video.uploads.create({
  new_asset_settings: {
    playback_policy: ["public"],
    encoding_tier: "baseline",
    generated_subtitles: [{ language_code: "en", name: "English" }],
  },
});
```

---

### **ğŸ¤– Phase 2: AI-Powered Context Analysis**

#### **GPT-4 Vision Frame Analysis**

- **Dual-frame context understanding** - Analyzes exit & entry frames
- **Visual scene comprehension** - Identifies objects, settings, mood, tone
- **Temporal gap calculation** - Determines optimal ad duration
- **Placement strategy generation** - Suggests best integration approach

**AI Analysis Pipeline:**

```typescript
Input: { frameA_image, frameB_image, gap_duration, product_info }
       â†“
GPT-4V Vision Analysis
       â†“
Output: {
  sceneContext: "Office environment with professional setting",
  visualElements: ["desk", "laptop", "corporate aesthetic"],
  suggestedDuration: 5.0,
  integrationStrategy: "Product placement on desk surface",
  reasoning: "Natural fit for tech product in professional context"
}
```

#### **Two Input Modes:**

**1. Image Upload Mode**

- Product image â†’ GPT-4V analysis
- Automatic product identification
- Feature extraction & description generation
- Brand color and style analysis

**2. Text Description Mode**

- Text prompt â†’ GPT-4 processing
- Detailed product description generation
- Style and tone suggestions
- Visual characteristics inference

---

### **ğŸ¨ Phase 3: AI Video Ad Generation**

#### **Sora 2.0 Integration (via Wan API)**

- **Context-aware prompts** generated by GPT-4
- **Style matching** to original video aesthetics
- **Duration control** (5-10 seconds)
- **High-quality output** (1080p, 24fps)

**Generation Workflow:**

```
Product Analysis â†’ Prompt Engineering â†’ Sora API Call â†’ Video Synthesis
       â†“                    â†“                  â†“              â†“
  "Red Coke Can"    "Professional ad    Wan 2.5 API     Generated
  + Context        showing Coke can   (Sora 2.0)       5-sec ad
                   on office desk..."
```

**Sample Generated Prompt:**

```
"A cinematic close-up shot of a Coca-Cola can placed on a modern
office desk, soft natural lighting from window, professional
corporate environment, smooth camera movement, 5 seconds duration,
high quality product shot matching the style of a business drama"
```

---

### **ğŸ”§ Phase 4: Professional Video Stitching**

#### **FFmpeg-Powered Assembly**

- **Frame-accurate insertion** at transition points
- **Audio continuity** preservation
- **Quality retention** (no re-encoding artifacts)
- **Multi-ad support** - stitch multiple ads in one pass

**Stitching Algorithm:**

```bash
# 1. Split original video at transition points
ffmpeg -i original.mp4 -ss 0 -to 67.5 segment_1.mp4
ffmpeg -i original.mp4 -ss 72.5 -to 180 segment_2.mp4

# 2. Create concat list
echo "file segment_1.mp4" > concat.txt
echo "file ad_1.mp4" >> concat.txt
echo "file segment_2.mp4" >> concat.txt

# 3. Seamless concatenation
ffmpeg -f concat -safe 0 -i concat.txt -c copy final.mp4
```

**Selection System:**

- âœ… Checkbox-based ad selection
- ğŸ“Š Real-time preview before stitching
- ğŸ”„ Re-stitch with different combinations
- ğŸ’¾ Download locally or upload to Mux

---

### **ğŸ¬ Phase 5: Mux Player Integration**

#### **Professional Video Player**

- **Adaptive bitrate streaming** via HLS
- **Custom UI controls** with brand colors
- **Responsive design** for all screen sizes
- **Keyboard shortcuts** for accessibility

#### **Visual Ad Markers**

```typescript
// Yellow markers appear on timeline showing ad placements
adMarkers={[
  { time: 67.5, duration: 5.0, label: "Coke Ad" },
  { time: 145.2, duration: 7.5, label: "iPhone Ad" }
]}
```

**Features:**

- ğŸŸ¡ **Hover-to-show** - Markers fade in on mouse hover
- ğŸ“ **Precise positioning** - Calculated as percentage of total duration
- â±ï¸ **Duration-accurate** - Marker width reflects actual ad length
- ğŸ¯ **Interactive** - Click markers to jump to ad segments

**Visual Implementation:**

```tsx
{
  /* Yellow overlay markers on timeline */
}
<div
  style={{
    left: `${(adTime / totalDuration) * 100}%`,
    width: `${(adDuration / totalDuration) * 100}%`,
    backgroundColor: "#FFD700",
    opacity: isHovering ? 0.9 : 0,
    transition: "opacity 300ms",
  }}
/>;
```

---

### **ğŸ§  Phase 6: AI-Generated Metadata**

#### **Smart Chapter Generation**

- **Mux caption analysis** - Reads auto-generated VTT files
- **GPT-4 processing** - Identifies logical chapter breaks
- **Timestamp extraction** - Maps chapters to video timeline
- **Title generation** - Creates descriptive chapter names

**Chapter Structure:**

```typescript
{
  startTime: 0,      // seconds
  title: "Introduction to Product Features"
},
{
  startTime: 45,
  title: "Technical Specifications Deep Dive"
}
```

**Integration:**

- ğŸ“š Appears in Mux Player chapter menu
- âŒ¨ï¸ Keyboard navigation (Ctrl + â†’/â†)
- ğŸ” Searchable chapter list
- ğŸ¯ Click to jump to chapter

#### **AI Video Summary**

- **Title generation** - SEO-optimized video title
- **Description** - Comprehensive 2-3 sentence summary
- **Tag extraction** - Relevant keywords for discoverability

**Example Output:**

```json
{
  "title": "Complete iPhone 15 Pro Review: Features & Performance",
  "description": "An in-depth analysis of the iPhone 15 Pro...",
  "tags": ["technology", "smartphone", "Apple", "review", "2024"]
}
```

---

### **ğŸŒ Phase 7: Multi-Language Support**

#### **Caption Translation**

- **5 target languages:** Spanish, French, German, Japanese, Hindi
- **GPT-4 translation** - Context-aware, natural translations
- **VTT format preservation** - Maintains timing and formatting
- **Mux Player integration** - Native caption selector UI

**Translation Pipeline:**

```
English Captions (VTT) â†’ Parse Text â†’ GPT-4 Translate â†’ Reconstruct VTT
         â†“                    â†“              â†“                â†“
   "Hello world"      Extract lines    "Hola mundo"    Updated VTT
   00:00:01 â†’ 00:00:03                 (Spanish)        with timing
```

**Languages Available:**

- ğŸ‡¬ğŸ‡§ English (Original)
- ğŸ‡ªğŸ‡¸ Spanish (EspaÃ±ol)
- ğŸ‡«ğŸ‡· French (FranÃ§ais)
- ğŸ‡©ğŸ‡ª German (Deutsch)
- ğŸ‡¯ğŸ‡µ Japanese (æ—¥æœ¬èª)
- ğŸ‡®ğŸ‡³ Hindi (à¤¹à¤¿à¤¨à¥à¤¦à¥€)

---

## ğŸ—ï¸ **System Architecture**

### **High-Level Architecture**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER INTERFACE                          â”‚
â”‚  (Next.js 15 + React + Tailwind + shadcn/ui + Mux Player)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND API ROUTES                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Upload  â”‚  â”‚  Analyze â”‚  â”‚ Generate â”‚  â”‚  Stitch  â”‚       â”‚
â”‚  â”‚   /mux   â”‚  â”‚  /frames â”‚  â”‚  /sora   â”‚  â”‚  /ffmpeg â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚             â”‚             â”‚
        â–¼             â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXTERNAL SERVICES                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   Mux    â”‚  â”‚  OpenAI  â”‚  â”‚   Wan    â”‚  â”‚  FFmpeg  â”‚       â”‚
â”‚  â”‚   API    â”‚  â”‚ GPT-4V   â”‚  â”‚  Sora    â”‚  â”‚  Binary  â”‚       â”‚
â”‚  â”‚          â”‚  â”‚   API    â”‚  â”‚   2.0    â”‚  â”‚          â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚             â”‚             â”‚
        â–¼             â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DATA STORAGE                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ LocalStorage â”‚  â”‚   /tmp/ads   â”‚  â”‚  /tmp/final  â”‚         â”‚
â”‚  â”‚  (Projects)  â”‚  â”‚  (Generated) â”‚  â”‚  (Stitched)  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **Data Flow Diagram**

```
USER UPLOADS VIDEO
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Upload to Mux                       â”‚
â”‚  â€¢ Direct upload API                    â”‚
â”‚  â€¢ Get asset ID & playback ID          â”‚
â”‚  â€¢ Auto-generate captions               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Scene Detection (PySceneDetect)     â”‚
â”‚  â€¢ Download video from Mux              â”‚
â”‚  â€¢ Detect transitions (threshold=27)    â”‚
â”‚  â€¢ Extract frame pairs                  â”‚
â”‚  â€¢ Upload frames to Mux                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. For Each Transition:                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ A. User Uploads Product         â”‚   â”‚
â”‚  â”‚    â€¢ Image OR Text              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚             â–¼                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ B. GPT-4V Analysis              â”‚   â”‚
â”‚  â”‚    â€¢ Analyze exit/entry frames  â”‚   â”‚
â”‚  â”‚    â€¢ Analyze product            â”‚   â”‚
â”‚  â”‚    â€¢ Generate strategy          â”‚   â”‚
â”‚  â”‚    â€¢ Create Sora prompt         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚             â–¼                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ C. Sora 2.0 Generation          â”‚   â”‚
â”‚  â”‚    â€¢ Send prompt to Wan API     â”‚   â”‚
â”‚  â”‚    â€¢ Poll for completion        â”‚   â”‚
â”‚  â”‚    â€¢ Download generated video   â”‚   â”‚
â”‚  â”‚    â€¢ Store in /tmp/ads          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚             â–¼                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ D. User Reviews & Selects       â”‚   â”‚
â”‚  â”‚    â€¢ Preview generated ad       â”‚   â”‚
â”‚  â”‚    â€¢ Select for final video     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. Stitch Final Video (FFmpeg)         â”‚
â”‚  â€¢ Split original at transitions        â”‚
â”‚  â€¢ Insert selected ads                  â”‚
â”‚  â€¢ Concatenate segments                 â”‚
â”‚  â€¢ Save to /tmp/final                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. Upload to Mux (Optional)            â”‚
â”‚  â€¢ Direct upload final video            â”‚
â”‚  â€¢ Get new asset & playback ID         â”‚
â”‚  â€¢ Display in Mux Player               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. Generate AI Features                â”‚
â”‚  â€¢ Fetch captions from Mux              â”‚
â”‚  â€¢ GPT-4 chapter generation             â”‚
â”‚  â€¢ GPT-4 summary generation             â”‚
â”‚  â€¢ Display in UI                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  7. Translate Captions (Optional)       â”‚
â”‚  â€¢ Fetch English VTT                    â”‚
â”‚  â€¢ GPT-4 translation (5 languages)      â”‚
â”‚  â€¢ Reconstruct VTT files                â”‚
â”‚  â€¢ Add to Mux Player                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
      FINAL VIDEO WITH:
      âœ… Seamless ad integration
      âœ… AI chapters
      âœ… AI summary & tags
      âœ… Multi-language captions
      âœ… Visual ad markers
      âœ… Professional streaming
```

---

### **Component Architecture**

```
app/
â”œâ”€â”€ page.tsx                    # Landing page with upload
â”œâ”€â”€ review/[id]/page.tsx       # Main application interface
â”‚
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ upload/route.ts        # Mux video upload
â”‚   â”œâ”€â”€ detect/route.ts        # PySceneDetect execution
â”‚   â”œâ”€â”€ analyze/route.ts       # GPT-4V frame analysis
â”‚   â”œâ”€â”€ generate/route.ts      # Sora video generation
â”‚   â”œâ”€â”€ stitch/route.ts        # FFmpeg video stitching
â”‚   â”‚
â”‚   â””â”€â”€ mux/
â”‚       â”œâ”€â”€ upload-final/route.ts      # Final video upload
â”‚       â”œâ”€â”€ ai-features/route.ts       # AI chapters/summary
â”‚       â””â”€â”€ translate-captions/route.ts # Caption translation
â”‚
â””â”€â”€ components/
    â”œâ”€â”€ UploadForm.tsx             # Video upload interface
    â”œâ”€â”€ ProductInput.tsx           # Product upload (img/text)
    â”œâ”€â”€ PromptEditor.tsx           # Review/edit Sora prompt
    â”œâ”€â”€ VideoPreview.tsx           # Generated ad preview
    â””â”€â”€ MuxPlayerWithMarkers.tsx   # Final video player
```

---

## ğŸ¨ **User Journey Flow**

### **Complete Workflow Visualization**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: VIDEO UPLOAD                                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ User drags/drops video file                             â”‚    â”‚
â”‚ â”‚         â†“                                               â”‚    â”‚
â”‚ â”‚ Upload to Mux (direct upload)                           â”‚    â”‚
â”‚ â”‚         â†“                                               â”‚    â”‚
â”‚ â”‚ Scene detection begins automatically                    â”‚    â”‚
â”‚ â”‚         â†“                                               â”‚    â”‚
â”‚ â”‚ Redirect to /review/[project_id]                        â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: REVIEW TRANSITIONS                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ Display all detected scene transitions                  â”‚    â”‚
â”‚ â”‚ Each shows: [Exit Frame] â†’ [Entry Frame]               â”‚    â”‚
â”‚ â”‚                                                         â”‚    â”‚
â”‚ â”‚ Transition 1: 0:45 â†’ 0:50 (5s gap)                     â”‚    â”‚
â”‚ â”‚ Transition 2: 1:23 â†’ 1:28 (5s gap)                     â”‚    â”‚
â”‚ â”‚ Transition 3: 2:15 â†’ 2:22 (7s gap)                     â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: PRODUCT INPUT (For Each Transition)                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ User chooses input mode:                                â”‚    â”‚
â”‚ â”‚                                                         â”‚    â”‚
â”‚ â”‚ OPTION A: Upload Product Image                          â”‚    â”‚
â”‚ â”‚    â”œâ”€ Drag/drop or browse                              â”‚    â”‚
â”‚ â”‚    â”œâ”€ Image preview shown                              â”‚    â”‚
â”‚ â”‚    â””â”€ Click "Analyze with GPT-4 Vision"               â”‚    â”‚
â”‚ â”‚                                                         â”‚    â”‚
â”‚ â”‚ OPTION B: Describe Product (Text)                       â”‚    â”‚
â”‚ â”‚    â”œâ”€ Enter product description                        â”‚    â”‚
â”‚ â”‚    â”œâ”€ Example: "Red Coca-Cola can, modern design"     â”‚    â”‚
â”‚ â”‚    â””â”€ Click "Analyze with GPT-4"                       â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: AI ANALYSIS & PROMPT GENERATION                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ GPT-4V analyzes:                                        â”‚    â”‚
â”‚ â”‚  â€¢ Exit frame visual context                            â”‚    â”‚
â”‚ â”‚  â€¢ Entry frame visual context                           â”‚    â”‚
â”‚ â”‚  â€¢ Product characteristics                              â”‚    â”‚
â”‚ â”‚  â€¢ Temporal gap duration                                â”‚    â”‚
â”‚ â”‚                                                         â”‚    â”‚
â”‚ â”‚ Generates:                                              â”‚    â”‚
â”‚ â”‚  âœ“ Product name & description                          â”‚    â”‚
â”‚ â”‚  âœ“ Integration strategy                                â”‚    â”‚
â”‚ â”‚  âœ“ Placement reasoning                                 â”‚    â”‚
â”‚ â”‚  âœ“ Sora 2.0 video prompt                               â”‚    â”‚
â”‚ â”‚  âœ“ Suggested duration                                  â”‚    â”‚
â”‚ â”‚                                                         â”‚    â”‚
â”‚ â”‚ User can:                                               â”‚    â”‚
â”‚ â”‚  âœï¸  Edit generated prompt                              â”‚    â”‚
â”‚ â”‚  â±ï¸  Adjust duration (5-10s)                            â”‚    â”‚
â”‚ â”‚  â–¶ï¸  Click "Generate Ad Video"                          â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: SORA VIDEO GENERATION                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ Progress indicator shows:                               â”‚    â”‚
â”‚ â”‚  0-30%:  Creating visual composite...                   â”‚    â”‚
â”‚ â”‚  30-70%: Sora generating video...                       â”‚    â”‚
â”‚ â”‚  70-100%: Finalizing...                                â”‚    â”‚
â”‚ â”‚                                                         â”‚    â”‚
â”‚ â”‚ Generated video:                                        â”‚    â”‚
â”‚ â”‚  â€¢ Saved to /tmp/ads/                                   â”‚    â”‚
â”‚ â”‚  â€¢ Video preview shown                                  â”‚    â”‚
â”‚ â”‚  â€¢ Checkbox: "Include in final video"                   â”‚    â”‚
â”‚ â”‚                                                         â”‚    â”‚
â”‚ â”‚ User can:                                               â”‚    â”‚
â”‚ â”‚  â˜‘ï¸  Select ad for final video                          â”‚    â”‚
â”‚ â”‚  ğŸ”„  Generate different version                         â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 6: REPEAT FOR OTHER TRANSITIONS                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ User repeats Steps 3-5 for each transition              â”‚    â”‚
â”‚ â”‚                                                         â”‚    â”‚
â”‚ â”‚ Transition 1: âœ… Coke ad generated & selected           â”‚    â”‚
â”‚ â”‚ Transition 2: âœ… iPhone ad generated & selected         â”‚    â”‚
â”‚ â”‚ Transition 3: â¹ï¸  Skipped (user choice)                 â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 7: STITCH FINAL VIDEO                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ Summary shows selected ads:                             â”‚    â”‚
â”‚ â”‚  â€¢ "2 Ads Selected"                                     â”‚    â”‚
â”‚ â”‚  â€¢ Transition #1, Transition #2                         â”‚    â”‚
â”‚ â”‚                                                         â”‚    â”‚
â”‚ â”‚ Click "Stitch 2 Ads into Video"                         â”‚    â”‚
â”‚ â”‚         â†“                                               â”‚    â”‚
â”‚ â”‚ FFmpeg stitching progress:                              â”‚    â”‚
â”‚ â”‚  0-25%:   Splitting original video...                   â”‚    â”‚
â”‚ â”‚  25-50%:  Inserting ads...                             â”‚    â”‚
â”‚ â”‚  50-75%:  Concatenating segments...                     â”‚    â”‚
â”‚ â”‚  75-100%: Finalizing output...                         â”‚    â”‚
â”‚ â”‚         â†“                                               â”‚    â”‚
â”‚ â”‚ Final video ready!                                      â”‚    â”‚
â”‚ â”‚  â€¢ Preview in HTML5 player                              â”‚    â”‚
â”‚ â”‚  â€¢ Download button available                            â”‚    â”‚
â”‚ â”‚  â€¢ "Upload to Mux" button available                     â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 8: UPLOAD TO MUX (Optional)                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ Click "Upload to Mux"                                   â”‚    â”‚
â”‚ â”‚         â†“                                               â”‚    â”‚
â”‚ â”‚ Direct upload to Mux:                                   â”‚    â”‚
â”‚ â”‚  â€¢ Creates new Mux asset                                â”‚    â”‚
â”‚ â”‚  â€¢ Gets playback ID                                     â”‚    â”‚
â”‚ â”‚  â€¢ Auto-generates captions                              â”‚    â”‚
â”‚ â”‚         â†“                                               â”‚    â”‚
â”‚ â”‚ Video now plays in Mux Player with:                     â”‚    â”‚
â”‚ â”‚  ğŸŸ¡ Yellow ad markers on timeline                       â”‚    â”‚
â”‚ â”‚  ğŸ“º Professional player controls                        â”‚    â”‚
â”‚ â”‚  ğŸ“Š Mux Asset ID displayed                              â”‚    â”‚
â”‚ â”‚  ğŸ“‹ Copy buttons for IDs                                â”‚    â”‚
â”‚ â”‚  ğŸ”— Link to Mux Dashboard                               â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 9: GENERATE AI FEATURES (Optional)                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ Click "Generate AI Features"                            â”‚    â”‚
â”‚ â”‚         â†“                                               â”‚    â”‚
â”‚ â”‚ AI processing:                                          â”‚    â”‚
â”‚ â”‚  1ï¸âƒ£  Fetch captions from Mux                            â”‚    â”‚
â”‚ â”‚  2ï¸âƒ£  GPT-4 analyzes transcript                          â”‚    â”‚
â”‚ â”‚  3ï¸âƒ£  Generate chapters with timestamps                  â”‚    â”‚
â”‚ â”‚  4ï¸âƒ£  Generate video summary                             â”‚    â”‚
â”‚ â”‚  5ï¸âƒ£  Extract relevant tags                              â”‚    â”‚
â”‚ â”‚         â†“                                               â”‚    â”‚
â”‚ â”‚ Results displayed:                                      â”‚    â”‚
â”‚ â”‚  ğŸ“š AI Chapters (8)                                     â”‚    â”‚
â”‚ â”‚     â€¢ 0:00 - Introduction                               â”‚    â”‚
â”‚ â”‚     â€¢ 0:45 - Product Features                           â”‚    â”‚
â”‚ â”‚     â€¢ 1:23 - Technical Specs                            â”‚    â”‚
â”‚ â”‚                                                         â”‚    â”‚
â”‚ â”‚  ğŸ“ AI Summary                                          â”‚    â”‚
â”‚ â”‚     Title: "Complete Product Review..."                â”‚    â”‚
â”‚ â”‚     Description: "An in-depth analysis..."             â”‚    â”‚
â”‚ â”‚     Tags: [tech, review, 2024, product]                â”‚    â”‚
â”‚ â”‚                                                         â”‚    â”‚
â”‚ â”‚ Chapters integrated into Mux Player!                    â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 10: TRANSLATE CAPTIONS (Optional)                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ Click "ğŸŒ Translate Captions"                           â”‚    â”‚
â”‚ â”‚         â†“                                               â”‚    â”‚
â”‚ â”‚ Translation process:                                    â”‚    â”‚
â”‚ â”‚  1ï¸âƒ£  Fetch English VTT from Mux                         â”‚    â”‚
â”‚ â”‚  2ï¸âƒ£  Parse caption text                                 â”‚    â”‚
â”‚ â”‚  3ï¸âƒ£  GPT-4 translates to 5 languages                    â”‚    â”‚
â”‚ â”‚  4ï¸âƒ£  Reconstruct VTT with timings                       â”‚    â”‚
â”‚ â”‚  5ï¸âƒ£  Add tracks to Mux Player                           â”‚    â”‚
â”‚ â”‚         â†“                                               â”‚    â”‚
â”‚ â”‚ Available languages:                                    â”‚    â”‚
â”‚ â”‚  ğŸ‡¬ğŸ‡§ English  ğŸ‡ªğŸ‡¸ Spanish  ğŸ‡«ğŸ‡· French                    â”‚    â”‚
â”‚ â”‚  ğŸ‡©ğŸ‡ª German   ğŸ‡¯ğŸ‡µ Japanese  ğŸ‡®ğŸ‡³ Hindi                    â”‚    â”‚
â”‚ â”‚                                                         â”‚    â”‚
â”‚ â”‚ Users can switch languages in player!                   â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                     âœ… COMPLETE!
                Professional video with:
                â€¢ Seamless AI-generated ads
                â€¢ Visual timeline markers
                â€¢ AI chapters & summary
                â€¢ Multi-language captions
                â€¢ Mux-powered streaming
```

---

## ğŸ’» **Tech Stack**

### **Frontend**

- **Framework:** Next.js 15 (App Router)
- **Language:** TypeScript 5.0
- **Styling:** Tailwind CSS 3.4
- **UI Components:** shadcn/ui
- **Video Player:** @mux/mux-player-react
- **State Management:** React Hooks (useState, useEffect)
- **Storage:** LocalStorage (project persistence)

### **Backend APIs**

- **Runtime:** Node.js 20+
- **Framework:** Next.js API Routes
- **Video Processing:** FFmpeg (binary)
- **Scene Detection:** PySceneDetect (Python subprocess)
- **File System:** Node.js `fs` module

### **External Services**

- **Video Infrastructure:** Mux (Upload, Streaming, Captions)
- **AI Vision:** OpenAI GPT-4 Vision (gpt-4-vision-preview)
- **AI Text:** OpenAI GPT-4 Turbo (gpt-4-turbo-preview)
- **Video Generation:** Wan API (Sora 2.0 integration)

### **Development Tools**

- **Package Manager:** npm
- **Code Quality:** ESLint, Prettier
- **Version Control:** Git

---

## ğŸ“Š **API Endpoints**

### **Video Upload**

```typescript
POST /api/upload
Body: FormData { file: File }
Response: {
  success: true,
  project: {
    id: string,
    mux_asset_id: string,
    playback_id: string,
    title: string
  }
}
```

### **Scene Detection**

```typescript
POST /api/detect
Body: { assetId: string, playbackId: string }
Response: {
  success: true,
  transitions: Array<{
    id: string,
    frame_a_time: number,
    frame_b_time: number,
    frame_a_url: string,
    frame_b_url: string
  }>
}
```

### **Frame Analysis**

```typescript
POST /api/analyze
Body: {
  frameAUrl: string,
  frameBUrl: string,
  gapDuration: number,
  product: File | string,
  mode: 'image' | 'text'
}
Response: {
  success: true,
  analysis: {
    productName: string,
    detailedProductDescription: string,
    integrationStrategy: string,
    reasoning: string,
    soraPrompt: string,
    duration: number
  }
}
```

### **Video Generation**

```typescript
POST /api/generate
Body: {
  prompt: string,
  duration: number
}
Response: {
  success: true,
  generationId: string
}

GET /api/generate/status/:id
Response: {
  success: true,
  status: 'pending' | 'processing' | 'completed' | 'failed',
  progress: number,
  videoUrl?: string
}
```

### **Video Stitching**

```typescript
POST /api/stitch
Body: {
  projectId: string,
  selectedTransitions: string[]
}
Response: {
  success: true,
  status: 'completed',
  videoUrl: string,
  videoPath: string
}

GET /api/stitch/status/:id
Response: {
  success: true,
  status: string,
  progress: number,
  videoUrl?: string
}
```

### **Mux Upload**

```typescript
POST /api/mux/upload-final
Body: {
  videoPath: string
}
Response: {
  success: true,
  assetId: string,
  playbackId: string
}
```

### **AI Features**

```typescript
POST /api/mux/ai-features
Body: {
  assetId: string
}
Response: {
  success: true,
  chapters: Array<{ startTime: number, title: string }>,
  summary: {
    title: string,
    description: string,
    tags: string[]
  }
}
```

### **Caption Translation**

```typescript
POST /api/mux/translate-captions
Body: {
  assetId: string
}
Response: {
  success: true,
  translations: Array<{
    language: string,
    name: string,
    status: 'completed',
    content: string (VTT)
  }>
}
```

---

## ğŸš€ **Getting Started**

### **Prerequisites**

```bash
# Required software
Node.js >= 20.0.0
npm >= 10.0.0
Python >= 3.8 (for PySceneDetect)
FFmpeg >= 4.4

# Check versions
node --version
npm --version
python --version
ffmpeg -version
```

### **Installation**

```bash
# 1. Clone the repository
git clone https://github.com/yourusername/muxai-adsplacement.git
cd muxai-adsplacement

# 2. Install dependencies
npm install

# 3. Install Python dependencies
pip install scenedetect[opencv] --break-system-packages

# 4. Set up environment variables
cp .env.example .env.local
```

### **Environment Variables**

Create `.env.local` with the following:

```bash
# Mux Configuration
MUX_TOKEN_ID=your_mux_token_id
MUX_TOKEN_SECRET=your_mux_token_secret

# OpenAI Configuration
OPENAI_API_KEY=your_openai_api_key

# Wan API Configuration (Sora 2.0)
WAN_API_KEY=your_wan_api_key

# Optional: ElevenLabs (if using audio dubbing)
ELEVENLABS_API_KEY=your_elevenlabs_api_key
```

### **Get API Keys**

1. **Mux**: https://dashboard.mux.com/settings/access-tokens
2. **OpenAI**: https://platform.openai.com/api-keys
3. **Wan (Sora)**: Contact Wan API for access

### **Running Locally**

```bash
# Development mode
npm run dev

# Production build
npm run build
npm start

# Open browser
http://localhost:3000
```

---

## ğŸ“ **Project Structure**

```
muxai-adsplacement/
â”‚
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ page.tsx                  # Landing page
â”‚   â”œâ”€â”€ review/[id]/page.tsx      # Main app interface
â”‚   â”œâ”€â”€ layout.tsx                # Root layout
â”‚   â”œâ”€â”€ globals.css               # Global styles
â”‚   â”‚
â”‚   â””â”€â”€ api/                      # API Routes
â”‚       â”œâ”€â”€ upload/route.ts       # Mux upload
â”‚       â”œâ”€â”€ detect/route.ts       # Scene detection
â”‚       â”œâ”€â”€ analyze/route.ts      # GPT-4V analysis
â”‚       â”œâ”€â”€ generate/
â”‚       â”‚   â”œâ”€â”€ route.ts          # Sora generation
â”‚       â”‚   â””â”€â”€ status/[id]/route.ts
â”‚       â”œâ”€â”€ stitch/
â”‚       â”‚   â”œâ”€â”€ route.ts          # FFmpeg stitching
â”‚       â”‚   â””â”€â”€ status/[id]/route.ts
â”‚       â”œâ”€â”€ video/[filename]/route.ts
â”‚       â”‚
â”‚       â””â”€â”€ mux/
â”‚           â”œâ”€â”€ upload-final/route.ts
â”‚           â”œâ”€â”€ ai-features/route.ts
â”‚           â””â”€â”€ translate-captions/route.ts
â”‚
â”œâ”€â”€ components/                   # React Components
â”‚   â”œâ”€â”€ ui/                      # shadcn/ui components
â”‚   â”‚   â”œâ”€â”€ button.tsx
â”‚   â”‚   â”œâ”€â”€ card.tsx
â”‚   â”‚   â”œâ”€â”€ badge.tsx
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ UploadForm.tsx           # Video upload
â”‚   â”œâ”€â”€ ProductInput.tsx         # Product input
â”‚   â”œâ”€â”€ PromptEditor.tsx         # Prompt editing
â”‚   â”œâ”€â”€ VideoPreview.tsx         # Video preview
â”‚   â””â”€â”€ MuxPlayerWithMarkers.tsx # Final player
â”‚
â”œâ”€â”€ lib/                         # Utilities
â”‚   â”œâ”€â”€ mux.ts                   # Mux client
â”‚   â”œâ”€â”€ openai.ts                # OpenAI client
â”‚   â”œâ”€â”€ types.ts                 # TypeScript types
â”‚   â””â”€â”€ utils.ts                 # Helper functions
â”‚
â”œâ”€â”€ tmp/                         # Temporary files
â”‚   â”œâ”€â”€ uploads/                 # Uploaded videos
â”‚   â”œâ”€â”€ frames/                  # Extracted frames
â”‚   â”œâ”€â”€ ads/                     # Generated ads
â”‚   â””â”€â”€ final/                   # Stitched videos
â”‚
â”œâ”€â”€ public/                      # Static assets
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ .env.local                   # Environment variables
â”œâ”€â”€ .gitignore
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ tailwind.config.ts
â”œâ”€â”€ next.config.js
â””â”€â”€ README.md
```

---

## ğŸ¯ **Key Features Breakdown**

### **1. Intelligent Scene Detection**

**Technology:** PySceneDetect with Content-Based Detection

**How it works:**

```python
# Detects scene changes based on visual content
detector = ContentDetector(threshold=27.0)

# Process video and find transitions
scene_list = detect(video_path, detector)

# For each transition:
for i, scene in enumerate(scene_list):
    # Extract exit frame (last frame of previous scene)
    exit_frame = scene[0].get_frames() - 1

    # Extract entry frame (first frame of new scene)
    entry_frame = scene[0].get_frames()
```

**Advantages:**

- âœ… Automatic detection (no manual marking)
- âœ… Frame-accurate timing
- âœ… Configurable sensitivity
- âœ… Fast processing (~1 min for 5-min video)

---

### **2. Context-Aware AI Analysis**

**Prompt Engineering for GPT-4 Vision:**

```typescript
const systemPrompt = `You are an expert video advertising strategist.
Analyze two video frames and a product to suggest seamless ad integration.

Context:
- Exit Frame: Last frame before transition
- Entry Frame: First frame after transition
- Gap Duration: ${gapDuration} seconds
- Product: ${productInfo}

Your task:
1. Understand visual context of both frames
2. Identify scene setting, mood, objects, colors
3. Determine how product can naturally fit
4. Generate Sora 2.0 prompt for seamless ad video

Requirements:
- Ad must feel natural, not forced
- Match visual style of original video
- Respect temporal gap duration
- Create smooth visual transition`;
```

**Sample Analysis Output:**

```json
{
  "productName": "Coca-Cola Zero Sugar Can",
  "detailedProductDescription": "Sleek red and black aluminum can...",
  "integrationStrategy": "Product placement on office desk surface",
  "reasoning": "The exit frame shows a corporate office with clean desk...",
  "soraPrompt": "Cinematic close-up of a Coca-Cola Zero can on modern office desk, natural window lighting, professional corporate environment, smooth camera pan from left to right, 5 seconds duration, high quality product shot matching business drama cinematography, shallow depth of field",
  "duration": 5.0
}
```

---

### **3. Sora 2.0 Video Generation**

**Integration via Wan API:**

```typescript
// Submit generation request
const response = await fetch("https://api.wan.ai/v1/generate", {
  method: "POST",
  headers: {
    Authorization: `Bearer ${WAN_API_KEY}`,
    "Content-Type": "application/json",
  },
  body: JSON.stringify({
    model: "sora-2.0",
    prompt: soraPrompt,
    duration: 5.0,
    resolution: "1080p",
    fps: 24,
  }),
});

// Poll for completion
const checkStatus = async (generationId) => {
  const status = await fetch(`https://api.wan.ai/v1/status/${generationId}`);
  if (status.completed) {
    return status.videoUrl;
  }
  // Poll every 2 seconds
  setTimeout(() => checkStatus(generationId), 2000);
};
```

**Generation Parameters:**

- **Model:** Sora 2.0
- **Duration:** 5-10 seconds (user-adjustable)
- **Resolution:** 1920x1080 (1080p)
- **Frame Rate:** 24 fps
- **Style:** Matches original video aesthetics

---

### **4. Frame-Accurate Video Stitching**

**FFmpeg Command Sequence:**

```bash
# Example: Insert 2 ads at different timestamps

# 1. Split original video into segments
ffmpeg -i original.mp4 -ss 0 -to 67.5 -c copy segment_1.mp4
ffmpeg -i original.mp4 -ss 72.5 -to 145.2 -c copy segment_2.mp4
ffmpeg -i original.mp4 -ss 152.7 -to 300 -c copy segment_3.mp4

# 2. Create concatenation file
cat > concat.txt << EOF
file 'segment_1.mp4'
file 'ad_coke.mp4'
file 'segment_2.mp4'
file 'ad_iphone.mp4'
file 'segment_3.mp4'
EOF

# 3. Concatenate without re-encoding (fast & lossless)
ffmpeg -f concat -safe 0 -i concat.txt -c copy final_with_ads.mp4
```

**Why this approach:**

- âœ… **No quality loss** - Uses `-c copy` (stream copy)
- âœ… **Fast processing** - No re-encoding needed
- âœ… **Frame-accurate** - Precise cut points
- âœ… **Audio preserved** - Maintains original audio tracks

---

### **5. Mux Player with Ad Markers**

**Implementation:**

```tsx
<MuxPlayer
  playbackId={finalVideoPlaybackId}
  accentColor="#FFD700"
  onLoadedMetadata={() => {
    // Add ad markers as CuePoints
    player.addCuePoints(
      adMarkers.map((marker) => ({
        startTime: marker.time,
        endTime: marker.time + marker.duration,
        value: { type: "ad", label: marker.label },
      }))
    );
  }}
/>;

{
  /* Visual overlay for timeline markers */
}
<div className="ad-markers-overlay">
  {adMarkers.map((marker) => (
    <div
      style={{
        left: `${(marker.time / duration) * 100}%`,
        width: `${(marker.duration / duration) * 100}%`,
        backgroundColor: "#FFD700",
        opacity: isHovering ? 0.9 : 0,
      }}
    />
  ))}
</div>;
```

**Features:**

- ğŸŸ¡ Yellow markers show ad locations
- â¯ï¸ Click markers to jump to ads
- ğŸ¯ Hover to reveal markers
- ğŸ“Š Accurate duration representation

---

## ğŸ§ª **Testing Guide**

### **Test Workflow**

**1. Upload Test Video**

```bash
# Use sample video
Duration: 5 minutes
Format: MP4
Resolution: 1080p
Expected transitions: 3-5
```

**2. Verify Scene Detection**

```bash
Expected: 3-5 transitions detected
Check: Frame pairs show clear visual changes
Verify: Timestamps are accurate
```

**3. Product Analysis Test**

**Image Mode:**

```
Upload: coca-cola.jpg
Expected output:
- Product name identified
- Features extracted
- Sora prompt generated
- Duration suggested (5-7s)
```

**Text Mode:**

```
Input: "Red iPhone 15 Pro with titanium finish"
Expected output:
- Detailed description generated
- Visual characteristics inferred
- Integration strategy created
```

**4. Video Generation**

```
Expected duration: 30-60 seconds
Progress updates: Every 2 seconds
Final output: MP4 file in /tmp/ads
```

**5. Stitching Test**

```
Select: 2 ads
Expected: Final video = original + 2 ads
Verify: Audio continuity maintained
Check: No visual glitches at transitions
```

**6. Mux Upload**

```
Expected: Asset created in <2 minutes
Verify: Playback ID returned
Check: Captions auto-generated
```

**7. AI Features**

```
Expected: 5-10 chapters
Verify: Timestamps are logical
Check: Summary is accurate
```

---

## ğŸ¨ **Screenshots & Demo**

### **Landing Page**

![Landing Page](docs/screenshots/landing.png)
_Clean upload interface with drag-and-drop support_

### **Transition Detection**

![Transitions](docs/screenshots/transitions.png)
_AI-detected scene transitions with frame previews_

### **Product Analysis**

![Analysis](docs/screenshots/analysis.png)
_GPT-4V analysis with integration strategy_

### **Generated Ad**

![Ad Preview](docs/screenshots/ad-preview.png)
_Sora-generated ad video preview_

### **Final Video with Markers**

![Mux Player](docs/screenshots/mux-player.png)
_Professional player with yellow ad markers_

### **AI Features**

![AI Features](docs/screenshots/ai-features.png)
_AI-generated chapters and summary_

---

## ğŸ”® **Future Roadmap**

### **Short Term (1-2 months)**

- [ ] **Batch Processing** - Upload multiple videos at once
- [ ] **Template Library** - Pre-made ad templates by category
- [ ] **A/B Testing** - Generate multiple ad variations
- [ ] **Analytics Dashboard** - Track engagement metrics

### **Medium Term (3-6 months)**

- [ ] **Real-time Preview** - Preview ads before generation
- [ ] **Custom Branding** - Upload brand guidelines
- [ ] **Collaborative Editing** - Team workflow support
- [ ] **Version Control** - Track edit history

### **Long Term (6-12 months)**

- [ ] **Live Streaming** - Real-time ad insertion for live streams
- [ ] **Mobile App** - iOS/Android native apps
- [ ] **API Access** - Public API for developers
- [ ] **Marketplace** - Buy/sell generated ads

---

## ğŸ“ˆ **Performance Metrics**

### **Processing Times**

| Task                             | Duration | Notes                    |
| -------------------------------- | -------- | ------------------------ |
| Video Upload (5 min video)       | ~30s     | Direct upload to Mux     |
| Scene Detection                  | ~1 min   | PySceneDetect processing |
| GPT-4V Analysis (per transition) | ~5s      | API call latency         |
| Sora Generation (5s ad)          | ~45s     | Depends on Wan API queue |
| Video Stitching (2 ads)          | ~10s     | FFmpeg concatenation     |
| Mux Upload (final video)         | ~60s     | Depends on file size     |
| AI Features Generation           | ~15s     | Caption analysis + GPT-4 |
| Caption Translation (5 langs)    | ~30s     | GPT-4 translation        |

**Total Time for Complete Workflow:**

- **Minimum:** ~3-4 minutes (1 transition)
- **Average:** ~8-10 minutes (3 transitions)
- **Maximum:** ~15-20 minutes (5+ transitions)

### **Cost Analysis** (per video)

| Service        | Cost      | Notes                      |
| -------------- | --------- | -------------------------- |
| Mux Upload     | $0.05     | Per GB uploaded            |
| Mux Streaming  | $0.10     | Per GB delivered           |
| OpenAI GPT-4V  | $0.03     | Per analysis ($0.01/image) |
| OpenAI GPT-4   | $0.02     | Per translation/summary    |
| Wan (Sora 2.0) | $1.50     | Per 5-second video         |
| **Total**      | **~$2-5** | Varies by # of ads         |

---

## ğŸ¤ **Contributing**

We welcome contributions! Here's how you can help:

### **Development Workflow**

```bash
# 1. Fork the repository
# 2. Create a feature branch
git checkout -b feature/amazing-feature

# 3. Make your changes
# 4. Commit with conventional commits
git commit -m "feat: add amazing feature"

# 5. Push to your fork
git push origin feature/amazing-feature

# 6. Open a Pull Request
```

### **Commit Convention**

- `feat:` New feature
- `fix:` Bug fix
- `docs:` Documentation changes
- `style:` Code style changes (formatting)
- `refactor:` Code refactoring
- `test:` Adding tests
- `chore:` Maintenance tasks

---

## ğŸ› **Troubleshooting**

### **Common Issues**

**Issue: Scene detection fails**

```bash
# Solution: Check Python and scenedetect installation
python --version  # Should be 3.8+
python -c "import scenedetect; print(scenedetect.__version__)"

# Reinstall if needed
pip install scenedetect[opencv] --break-system-packages
```

**Issue: FFmpeg not found**

```bash
# Solution: Install FFmpeg
# macOS
brew install ffmpeg

# Ubuntu/Debian
sudo apt install ffmpeg

# Windows
# Download from https://ffmpeg.org/download.html
```

**Issue: Mux upload fails**

```bash
# Solution: Check API credentials
# Verify in .env.local:
MUX_TOKEN_ID=your_token_id
MUX_TOKEN_SECRET=your_token_secret

# Test with Mux CLI
npm install -g @mux/cli
mux auth
```

**Issue: Video generation stuck**

```bash
# Solution: Check Wan API key and quota
# Verify API key is valid
# Check if you have remaining quota
# Monitor /api/generate/status/[id] endpoint
```

---

## ğŸ“œ **License**

MIT License - see [LICENSE](LICENSE) file for details

---

## ğŸ‘¥ **Team**

**Created by:** Aaditya Shah

**Role:** Full-Stack Developer, AI Engineer

**Contact:**

- Email: your.email@example.com
- GitHub: [@yourusername](https://github.com/yourusername)
- LinkedIn: [Your Name](https://linkedin.com/in/yourname)

---

## ğŸ™ **Acknowledgments**

Special thanks to:

- **Mux** - For providing the amazing video infrastructure and player
- **OpenAI** - For GPT-4 Vision and GPT-4 Turbo APIs
- **Wan.ai** - For Sora 2.0 API access
- **shadcn** - For the beautiful UI component library
- **Vercel** - For Next.js and deployment platform

---

## ğŸ“ **Support**

Having issues? We're here to help!

- ğŸ“§ **Email:** support@muxai-adsplacement.com
- ğŸ’¬ **Discord:** [Join our server](https://discord.gg/muxai)
- ğŸ“– **Documentation:** [docs.muxai-adsplacement.com](https://docs.muxai-adsplacement.com)
- ğŸ› **Bug Reports:** [GitHub Issues](https://github.com/yourusername/muxai-adsplacement/issues)

---

## â­ **Star History**

[![Star History Chart](https://api.star-history.com/svg?repos=yourusername/muxai-adsplacement&type=Date)](https://star-history.com/#yourusername/muxai-adsplacement&Date)

---

<div align="center">

### **Built with â¤ï¸ for DEV Worldwide Show and Tell Challenge 2024**

**Made possible by cutting-edge AI technology**

[ğŸŒ Live Demo](https://muxai-adsplacement.vercel.app) â€¢ [ğŸ“¹ Video Demo](https://youtube.com/watch?v=demo) â€¢ [ğŸ† Hackathon Submission](https://dev.to/submission)

---

**If you found this project helpful, please consider giving it a â­ï¸!**

</div>

---

## ğŸ“Š **Technical Deep Dive**

### **Mux Integration Details**

**Why Mux?**

1. **Direct Upload API** - No intermediate storage needed
2. **Auto-Transcoding** - Handles all format conversions
3. **Adaptive Streaming** - HLS for optimal playback
4. **Auto-Captions** - Speech-to-text built-in
5. **Professional Player** - Feature-rich, customizable
6. **Analytics** - Built-in QoE metrics

**Mux Asset Lifecycle:**

```
Upload â†’ Processing â†’ Ready
  â†“         â†“          â†“
30s      2-3min    Available

Processing includes:
- Video transcoding (multiple renditions)
- Audio normalization
- Thumbnail generation
- Caption generation (if enabled)
- Metadata extraction
```

**Mux Player Features Used:**

- âœ… Playback controls (play, pause, seek, volume)
- âœ… Fullscreen mode
- âœ… Picture-in-picture
- âœ… Keyboard shortcuts
- âœ… Chapter navigation
- âœ… Caption selection
- âœ… Quality selector (auto, 1080p, 720p, 480p)
- âœ… Playback speed control
- âœ… Time display
- âœ… Progress bar with buffering indicator

---

### **AI Model Configuration**

**GPT-4 Vision Settings:**

```typescript
{
  model: "gpt-4-vision-preview",
  max_tokens: 1500,
  temperature: 0.7,  // Balanced creativity
  top_p: 1.0,
  frequency_penalty: 0.0,
  presence_penalty: 0.0
}
```

**GPT-4 Turbo Settings (Chapters/Summary):**

```typescript
{
  model: "gpt-4-turbo-preview",
  max_tokens: 2000,
  temperature: 0.5,  // More focused
  top_p: 1.0,
  response_format: { type: "json_object" }
}
```

**Sora 2.0 Settings:**

```typescript
{
  model: "sora-2.0",
  duration: 5.0,      // 5-10 seconds
  resolution: "1080p",
  fps: 24,
  style_strength: 0.8, // How closely to match style
  motion_intensity: 0.6 // Camera movement amount
}
```

---

### **Security Considerations**

**API Key Protection:**

```typescript
// Never expose API keys in frontend
// All API calls go through Next.js API routes

// Backend only
const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY, // Server-side only
});
```

**File Upload Validation:**

```typescript
// Validate file type and size
const allowedTypes = ["video/mp4", "video/quicktime", "video/x-msvideo"];
const maxSize = 500 * 1024 * 1024; // 500 MB

if (!allowedTypes.includes(file.type)) {
  throw new Error("Invalid file type");
}

if (file.size > maxSize) {
  throw new Error("File too large");
}
```

**Rate Limiting:**

```typescript
// Implement rate limiting for API routes
// Prevent abuse and control costs

const rateLimit = {
  "/api/generate": {
    max: 10, // Max 10 requests
    window: 3600, // Per hour
  },
};
```

---

## ğŸ“ **Learning Resources**

Want to build something similar? Check out these resources:

### **Mux Resources**

- [Mux Documentation](https://docs.mux.com)
- [Mux Player Guide](https://docs.mux.com/guides/player)
- [Mux API Reference](https://docs.mux.com/api-reference)

### **OpenAI Resources**

- [GPT-4 Vision Guide](https://platform.openai.com/docs/guides/vision)
- [Prompt Engineering](https://platform.openai.com/docs/guides/prompt-engineering)

### **Video Processing**

- [FFmpeg Documentation](https://ffmpeg.org/documentation.html)
- [PySceneDetect](https://scenedetect.com)

### **Next.js**

- [Next.js 15 Documentation](https://nextjs.org/docs)
- [App Router Guide](https://nextjs.org/docs/app)

---

## ğŸ¯ **Use Cases**

**1. Content Creators**

- YouTube creators monetizing videos
- Course creators adding sponsor segments
- Podcast video editions with ads

**2. Marketing Agencies**

- Client video campaigns with product placements
- Social media content with branded integrations
- Influencer marketing videos

**3. E-commerce**

- Product demo videos with related item ads
- Tutorial videos with tool placements
- Review videos with affiliate links

**4. Streaming Platforms**

- VOD services with ad insertion
- Educational platforms with sponsor integrations
- Entertainment platforms with native ads

---

<div align="center">

## ğŸš€ **Ready to Transform Your Videos?**

### **[Try MuxAI AdsPlacement Now](https://muxai-adsplacement.vercel.app)**

---

### **Questions? Feedback? Contributions?**

**We'd love to hear from you!**

[Open an Issue](https://github.com/yourusername/muxai-adsplacement/issues) â€¢ [Start a Discussion](https://github.com/yourusername/muxai-adsplacement/discussions) â€¢ [Contact Us](mailto:support@muxai-adsplacement.com)

---

**Â© 2024 MuxAI AdsPlacement â€¢ Built for DEV Worldwide Show and Tell Challenge**

**Powered by Mux â€¢ OpenAI â€¢ Next.js**

</div>

---

**End of README.md**

ğŸ‰ **Thank you for checking out MuxAI AdsPlacement!** ğŸ‰
